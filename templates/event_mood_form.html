{% extends 'base.html' %}

{% block content %}
    <h1>Log your mood for an event:</h1>
    <form id='event-mood-form' action='/log_event_mood' method='POST'>
        <label for='event-name'>Event Name:</label>
        <input id='event-date' type-'text' name='event-name' required><br>
        <p> Duration 
            <link rel="stylesheet" href="//code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
            <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
            <label for='start-date'>Start:</label>
            <input id='start-date' type='text' name='start-date' required>
            <label for='end-date'>End:</label>
            <input id='end-date' type='text' name='end-date' required><br>
        </p>
        
        <script>
            // When DOM is ready, turn date input to datepicker
            $( function() {                 
                $( "#start-date" ).datepicker({
                    changeMonth: true,
                    changeYear: true,
                    // restrict date range from start date ago to current day
                    minDate: '-3M',
                    maxDate: new Date(),
                    dateFormat: 'yy-mm-dd'
                });
            $( function() {                 
                $( "#end-date" ).datepicker({
                    changeMonth: true,
                    changeYear: true,
                    // restrict date range from start date ago to current day
                    minDate: '-2M',
                    maxDate: new Date(),
                    dateFormat: 'yy-mm-dd'
                });
            } );
            } );
        </script>

        <label for='overall-mood'>Overall Mood: </label>
        <input id='overall-mood' type='number' name='overall-mood' min='-50' max='50' required><br>

        <p id='mood-range'>Range of Mood: 
        <label for='min-mood'>Min: </label>
        <input id='min-mood' type='number' name='min-mood' min='-50' max='50'>

        <label for='max-mood'>Max: </label>
        <input id='max-mood' type='number' name='max-mood' min='-50' max='50'><span id="alert-msg" style='color:red;'></span><br>
        </p>

        <label for='notes'>Notes About This Event:</label>
        <input id='notes' type='textarea' name='notes'><br>

        <input type='submit' value='Add Event Mood Log'>
    </form>


    <script>
        function validateMoodRange(evt){
            var overallMood = $('#overall-mood').val()
            var minMood = $('#min-mood').val()
            var maxMood = $('#max-mood').val()

            if ((minMood && maxMood)) {
                // .val() returns str, need to make it int for comparisons
                overallMood = parseInt(overallMood)
                minMood = parseInt(minMood)
                maxMood = parseInt(maxMood)

                if (minMood > maxMood) {
                    var msg = '** Min should not be greater than max **'
                    // evt.preventDefault();
                    // $('#alert-msg').html('** Min should not be greater than max **');
                }
                else if (!((minMood < overallMood) && (overallMood < maxMood))) {
                    var msg = '** Overall mood should be within mood range **'
                    // evt.preventDefault();
                    // $('#alert-msg').html('** Overall mood should be within mood range **');
                }
            }
            else if ((!minMood && maxMood) || (!maxMood && minMood)) {
                var msg = '** Both min and max must be entered or empty**';
            }

            if (msg) {
                evt.preventDefault();
                $('#alert-msg').html(msg);
            }
        }

        $('#event-mood-form').on('submit', validateMoodRange);

    </script>


{% endblock %}